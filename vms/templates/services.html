{% extends 'base.html' %}

{% block title %}Services{% endblock %}

{% block content %}
<div class="table_temp">
    <h2>Services</h2>
    <form method="post">
        {% csrf_token %}
        <table>
            <thead>
                <tr>
                    <th>Select</th>
                    <th>Image</th>
                    <th>Product Name</th>
                    <th>Price</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                    <tr>
                        <td><input type="checkbox" name="products" value="{{ product.id }}"></td>
                        <td>
                            {% if product.image %}
                                <img src="{{ product.image.url }}" alt="{{ product.name }}" width="50">
                            {% else %}
                                No Image
                            {% endif %}
                        </td>
                        <td>{{ product.name }}</td>
                        <td>${{ product.price }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="submit" name="action" value="calculate_total">Add to cart</button>
        
        {% if selected_products %}
            <h2>Selected Products</h2>
            <ul>
                {% for product in selected_products %}
                    <li>{{ product.name }} - ${{ product.price }}</li>
                {% endfor %}
            </ul>
            <h3>Total: ${{ total }}</h3>
            <button type="submit" name="action" value="send_email">Checkout/Email</button>
        {% endif %}
    </form>
</div>
{% endblock %}